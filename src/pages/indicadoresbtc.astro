---
import BaseLayout from '../layouts/BaseLayout.astro';
import '../styles/btc-dashboard.css';
---

<BaseLayout
  title="Indicadores BTC - Caio Leta"
  description="Sinais de compra e venda de Bitcoin baseados em indicadores on-chain e de mercado."
>
  <div class="btc-dashboard" data-locale="pt">

    <!-- Header -->
    <div class="bd-header">
      <h1>Term√¥metro do Bitcoin</h1>
      <p class="bd-subtitle">Sinais de compra e venda baseados em indicadores on-chain e de mercado</p>
    </div>

    <!-- Price banner -->
    <div class="bd-price-banner" id="bd-price-banner">
      <span class="bd-price-value">Carregando dados...</span>
    </div>

    <!-- Consolidated signal + help -->
    <div class="bd-signal-row">
      <div class="bd-consolidated" id="bd-consolidated">Calculando...</div>
      <button class="bd-help-btn" id="bd-help-btn" aria-label="Explicacao do sinal">?</button>
    </div>

    <!-- Explanation panel -->
    <div class="bd-explanation" id="bd-explanation">
      <h3>Como o sinal consolidado e calculado</h3>
      <p>Cada indicador gera um score individual de -2 (venda forte) a +2 (compra forte). O score consolidado e a media dos scores dos indicadores selecionados.</p>

      <table class="bd-score-table">
        <thead><tr><th>Score</th><th>Sinal</th></tr></thead>
        <tbody>
          <tr><td>+2</td><td style="color:#00C853">COMPRA FORTE</td></tr>
          <tr><td>+1</td><td style="color:#69F0AE">COMPRA</td></tr>
          <tr><td>0</td><td style="color:#FFD600">NEUTRO</td></tr>
          <tr><td>-1</td><td style="color:#FF6D00">VENDA</td></tr>
          <tr><td>-2</td><td style="color:#FF1744">VENDA FORTE</td></tr>
        </tbody>
      </table>

      <hr />
      <h4>Detalhamento atual</h4>
      <div id="bd-breakdown"></div>

      <hr />
      <h4>Escolha quais indicadores usar no calculo</h4>
      <div class="bd-checklist" id="bd-checklist">
        <label><input type="checkbox" value="mayer_multiple" checked /> Mayer Multiple</label>
        <label><input type="checkbox" value="200w_ma_ratio" checked /> 200W MA Ratio</label>
        <label><input type="checkbox" value="mvrv" checked /> MVRV Ratio</label>
        <label><input type="checkbox" value="fear_greed" checked /> Fear & Greed</label>
        <label><input type="checkbox" value="rsi_weekly" checked /> RSI Semanal BTC/USD</label>
        <label><input type="checkbox" value="rsi_monthly" checked /> RSI Mensal BTC/USD</label>
        <label><input type="checkbox" value="rsi_xau_weekly" checked /> RSI Semanal BTC/XAU</label>
        <label><input type="checkbox" value="rsi_xau_monthly" checked /> RSI Mensal BTC/XAU</label>
      </div>
    </div>

    <!-- Loading indicator -->
    <div class="bd-loading" id="bd-loading">
      <span class="bd-spinner"></span> Carregando dados...
    </div>

    <!-- Two-column layout -->
    <div class="bd-main">
      <!-- Left column: cards -->
      <div class="bd-left">
        <div class="bd-cards">
          <div class="bd-card" id="bd-card-mayer_multiple">
            <div class="bd-card-title">Mayer Multiple</div>
            <div class="bd-card-value" id="bd-card-value-mayer_multiple">...</div>
            <span class="bd-card-signal" id="bd-card-signal-mayer_multiple"></span>
          </div>
          <div class="bd-card" id="bd-card-200w_ma_ratio">
            <div class="bd-card-title">200W MA Ratio</div>
            <div class="bd-card-value" id="bd-card-value-200w_ma_ratio">...</div>
            <span class="bd-card-signal" id="bd-card-signal-200w_ma_ratio"></span>
          </div>
          <div class="bd-card" id="bd-card-mvrv">
            <div class="bd-card-title">MVRV Ratio</div>
            <div class="bd-card-value" id="bd-card-value-mvrv">...</div>
            <span class="bd-card-signal" id="bd-card-signal-mvrv"></span>
          </div>
          <div class="bd-card" id="bd-card-fear_greed">
            <div class="bd-card-title">Fear & Greed</div>
            <div class="bd-card-value" id="bd-card-value-fear_greed">...</div>
            <span class="bd-card-signal" id="bd-card-signal-fear_greed"></span>
          </div>
          <div class="bd-card" id="bd-card-rsi_weekly">
            <div class="bd-card-title">RSI Semanal BTC/USD</div>
            <div class="bd-card-value" id="bd-card-value-rsi_weekly">...</div>
            <span class="bd-card-signal" id="bd-card-signal-rsi_weekly"></span>
          </div>
          <div class="bd-card" id="bd-card-rsi_monthly">
            <div class="bd-card-title">RSI Mensal BTC/USD</div>
            <div class="bd-card-value" id="bd-card-value-rsi_monthly">...</div>
            <span class="bd-card-signal" id="bd-card-signal-rsi_monthly"></span>
          </div>
          <div class="bd-card" id="bd-card-rsi_xau_weekly">
            <div class="bd-card-title">RSI Semanal BTC/XAU</div>
            <div class="bd-card-value" id="bd-card-value-rsi_xau_weekly">...</div>
            <span class="bd-card-signal" id="bd-card-signal-rsi_xau_weekly"></span>
          </div>
          <div class="bd-card" id="bd-card-rsi_xau_monthly">
            <div class="bd-card-title">RSI Mensal BTC/XAU</div>
            <div class="bd-card-value" id="bd-card-value-rsi_xau_monthly">...</div>
            <span class="bd-card-signal" id="bd-card-signal-rsi_xau_monthly"></span>
          </div>
        </div>
      </div>

      <!-- Right column: chart panel (always visible) -->
      <div class="bd-right">
        <div class="bd-detail" id="bd-detail">
          <div id="bd-detail-content">
            <div class="bd-detail-placeholder">
              <p>Carregando grafico...</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="bd-footer">
      <span>BTC Signal Tracker | Dados atualizados a cada 5 minutos | </span>
      <span id="bd-last-update">Aguardando...</span>
    </div>

  </div>

  <script>
    import { initDashboard } from '../scripts/btc-dashboard';
    initDashboard('pt');
  </script>
</BaseLayout>
